# Инструкция по миграции сказочного мира на Wiki.js

## Подготовка к миграции

Мы создали набор инструментов для миграции вашего проекта "Приключения Цветочка, Торона и Руперта" на платформу Wiki.js.

### Предварительные требования

- Docker и Docker Compose
- Node.js (версия 14+)
- Доступ к исходному проекту

## Шаги по миграции

### 1. Запуск Wiki.js

Запустите Wiki.js с помощью Docker Compose:

```bash
npm run start
```

После запуска Wiki.js будет доступен по адресу: http://localhost:8080

### 2. Первоначальная настройка Wiki.js

1. Откройте http://localhost:8080 в браузере
2. Следуйте инструкциям по начальной настройке:
   - Создайте учетную запись администратора
   - В качестве языка выберите Русский
   - Настройте другие параметры по вашему усмотрению

### 3. Настройка API доступа

1. Войдите в административную панель (значок шестеренки)
2. Перейдите в раздел "Администрирование" > "API доступ"
3. Нажмите "Создать API ключ"
4. Назовите ключ, например, "Migration Key"
5. Установите полный доступ (или минимум права на чтение и запись страниц)
6. Скопируйте созданный токен

### 4. Настройка скрипта миграции

1. Откройте файл `improved-migration.js`
2. Замените `YOUR_API_TOKEN` на полученный API-токен
3. Убедитесь, что путь в переменной `sourceDir` указывает на корректную директорию с вашим проектом (путь относительно директории скрипта)

### 5. Запуск миграции

```bash
npm run migrate:improved
```

Скрипт выполнит следующие действия:

- Создаст главную страницу с общим обзором
- Автоматически преобразует относительные ссылки между файлами
- Добавит метаданные и теги к страницам
- Сохранит структуру директорий

## После миграции

### 1. Настройка навигации в Wiki.js

1. В административной панели перейдите в "Интерфейс" > "Навигация"
2. Создайте структуру навигации, например:
   ```
   - Главная
   - Персонажи
     - Главные герои
     - Злодеи
     - Друзья и союзники
     - Родственники
   - Места
   - Артефакты и магия
   - Взаимоотношения
   - Приключения
   ```

### 2. Настройка главной страницы

1. В административной панели перейдите в "Система" > "Общие настройки"
2. Установите "Домашнюю страницу" на "/home" (или другой путь, где находится ваша главная страница)

### 3. Настройка визуальных элементов

1. В административной панели перейдите в "Интерфейс" > "Темы"
2. Выберите цветовую схему, которая подойдет для сказочного мира
3. Загрузите логотип, если имеется

### 4. Проверка миграции

1. Пройдите по нескольким ссылкам на сайте, чтобы убедиться, что они работают
2. Проверьте корректность отображения контента и форматирования
3. Исправьте любые проблемы с помощью встроенного редактора Wiki.js

## Дополнительные настройки

### Добавление пользователей

1. В административной панели перейдите в "Пользователи"
2. Нажмите "Новый пользователь" для добавления других авторов или читателей

### Настройка резервного копирования

1. В административной панели перейдите в "Система" > "Хранение"
2. Настройте хранилище для бэкапов (например, локальная директория или облачное хранилище)
3. В разделе "Система" > "Бэкапы" настройте регулярные резервные копии

## Устранение неисправностей

Если что-то пошло не так во время миграции:

1. Проверьте логи Wiki.js:

   ```bash
   npm run logs
   ```

2. Убедитесь в корректности API-токена и URL

3. Если нужно перезапустить Wiki.js:

   ```bash
   npm run stop
   npm run start
   ```

4. При необходимости сбросьте настройки:
   ```bash
   npm run stop
   docker volume rm fairytale_wiki_db-data
   npm run start
   ```
   Внимание: это удалит все данные!

## Преимущества использования Wiki.js

После завершения миграции вы получите:

1. **Удобный поиск** - мгновенный поиск по всей базе знаний
2. **Улучшенная навигация** - меню и иерархия страниц
3. **История редактирования** - отслеживание всех изменений
4. **Управление доступом** - возможность настройки прав доступа
5. **Визуальный редактор** - режим WYSIWYG для простого редактирования
6. **API** - программный доступ к контенту

## Дальнейшее развитие проекта

После успешной миграции базовой структуры вы можете:

1. Добавить иллюстрации к персонажам и местам
2. Создать интерактивную карту мира (используя плагины Wiki.js)
3. Организовать хронологию событий
4. Добавить шаблоны для новых страниц
5. Настроить стили для различных типов страниц

---

В случае возникновения вопросов или проблем, обратитесь к документации Wiki.js: https://docs.requarks.io/
