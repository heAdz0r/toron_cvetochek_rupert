# Структура проекта WikiJs MCP

Этот документ описывает структуру проекта WikiJs MCP и назначение файлов.

## Основные файлы

### Скрипты запуска

- **mcp_wrapper.js** - универсальная обертка для запуска MCP сервера в различных режимах (HTTP или stdio) с учетом конфигурации Cursor
- **mcp_http_server.js** - HTTP сервер для Cursor MCP
- **mcp_wikijs_stdin.js** - сервер для Cursor MCP через stdio
- **start_http.sh** - скрипт для запуска HTTP сервера
- **start.sh** - скрипт для запуска базового сервера из директории dist

### Клиенты и тесты

- **mcp_client.js** - клиент для работы с MCP сервером через stdio
- **mcp_http_client.js** - клиент для работы с MCP сервером через HTTP
- **test_mcp.js** - скрипт для тестирования MCP
- **test_mcp_stdin.js** - скрипт для тестирования stdin-режима MCP

### Исходные файлы TypeScript

Директория `src/` содержит исходный код на TypeScript:

- **api.ts** - GraphQL API клиент для Wiki.js
- **server.ts** - HTTP сервер
- **tools.ts** - определения инструментов MCP
- **types.ts** - типы TypeScript
- **agent.ts** - класс агента для использования MCP
- **demo.ts** - демонстрационный скрипт

### Скомпилированные файлы

Директория `dist/` содержит скомпилированные TypeScript файлы:

- **api.js** - GraphQL API клиент
- **server.js** - HTTP сервер
- **tools.js** - инструменты MCP
- **types.js** - типы
- **agent.js** - агент MCP
- **demo.js** - демонстрация

### Конфигурационные файлы

- **package.json** - описание проекта и скрипты npm
- **tsconfig.json** - конфигурация TypeScript
- **example.env** - пример файла переменных окружения

## Конфигурация Cursor

Для работы с Cursor необходимо создать файл `.cursor/mcp.json` в вашем проекте или в домашней директории:

```json
{
  "mcpServers": {
    "wikijs": {
      "transport": "http",
      "url": "http://localhost:3200/mcp",
      "events": "http://localhost:3200/mcp/events",
      "cwd": "/путь/к/директории/wikijs-mcp",
      "env": {
        "WIKIJS_BASE_URL": "http://localhost:8080",
        "WIKIJS_TOKEN": "ваш-токен-wiki-js"
      }
    }
  }
}
```

## Запуск проекта

1. Установка зависимостей:

   ```bash
   npm install
   ```

2. Сборка TypeScript-файлов:

   ```bash
   npm run build
   ```

3. Запуск HTTP сервера:

   ```bash
   npm run server:http
   # или
   ./start_http.sh
   ```

4. Запуск stdio сервера:

   ```bash
   npm run server:stdio
   ```

5. Запуск с использованием конфигурации Cursor:
   ```bash
   node mcp_wrapper.js
   ```

## Использование клиентов

1. HTTP клиент:

   ```bash
   npm run http-client
   ```

2. stdio клиент:
   ```bash
   npm run client
   ```

## Тестирование

Для тестирования MCP:

```bash
node test_mcp.js
```
